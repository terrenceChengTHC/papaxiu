"use strict";define("admin/extend/rewards",["translator"],function(a){var e={};var t;var r;var n;var i;e.init=function(){t=ajaxify.data.rewards;r=ajaxify.data.active;n=ajaxify.data.conditions;i=ajaxify.data.conditionals;$("[data-selected]").each(function(){s($(this))});$("#active").on("change","[data-selected]",function(){d($(this))}).on("click",".delete",function(){var a=$(this).parents("[data-id]");var e=a.attr("data-id");socket.emit("admin.rewards.delete",{id:e},function(a){if(a){app.alertError(a.message)}else{app.alertSuccess("[[admin/extend/rewards:alert.delete-success]]")}});a.remove();return false}).on("click",".toggle",function(){var a=$(this);var e=a.hasClass("btn-success");a.toggleClass("btn-warning").toggleClass("btn-success").translateHtml("[[admin/extend/rewards:"+(e?"disable":"enable")+"]]");return false});$("#new").on("click",o);$("#save").on("click",f);l()};function s(a){a.val(a.attr("data-selected"));switch(a.attr("name")){case"rid":c(a);break}}function d(a){a.attr("data-selected",a.val());switch(a.attr("name")){case"rid":c(a);break}}function c(a){var e=a.parents("[data-rid]");var r=e.find(".inputs");var n;var i="";for(var s in t){if(t.hasOwnProperty(s)){if(t[s].rid===a.attr("data-selected")){n=t[s].inputs;e.attr("data-rid",t[s].rid);break}}}if(!n){return app.alertError("[[admin/extend/rewards:alert.no-inputs-found]] "+a.attr("data-selected"))}n.forEach(function(a){i+='<label for="'+a.name+'">'+a.label+"<br />";switch(a.type){case"select":i+='<select name="'+a.name+'">';a.values.forEach(function(a){i+='<option value="'+a.value+'">'+a.name+"</option>"});break;case"text":i+='<input type="text" name="'+a.name+'" />';break}i+="</label><br />"});r.html(i)}function l(){$("[data-rid]").each(function(a){var e=$(this).find(".inputs");var t=r[a].rewards;for(var n in t){if(t.hasOwnProperty(n)){e.find('[name="'+n+'"]').val(t[n])}}})}function o(){var e=$("#active");var r={active:[{disabled:true,value:"",claimable:1,rid:null,id:null}],conditions:n,conditionals:i,rewards:t};templates.parse("admin/extend/rewards","active",r,function(t){a.translate(t,function(a){a=$(a);e.append(a);a.find("select").val("")})})}function f(){var a=[];$("#active li").each(function(){var e={rewards:{}};var t=$(this).find("form.main").serializeArray();var r=$(this).find("form.rewards").serializeArray();t.forEach(function(a){e[a.name]=a.value});r.forEach(function(a){e.rewards[a.name]=a.value});e.id=$(this).attr("data-id");e.disabled=$(this).find(".toggle").hasClass("btn-success");a.push(e)});socket.emit("admin.rewards.save",a,function(a){if(a){app.alertError(a.message)}else{app.alertSuccess("[[admin/extend/rewards:alert.save-success]]")}})}return e});
//# sourceMappingURL=public/src/admin/extend/rewards.js.map