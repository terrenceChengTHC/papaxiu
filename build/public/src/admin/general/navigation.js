"use strict";define("admin/general/navigation",["translator","iconSelect","jqueryui"],function(a,e){var n={};var i;n.init=function(){i=ajaxify.data.available;$("#enabled .unescape").each(function(){$(this).val(a.unescape($(this).val()))});a.translate($("#available").html(),function(e){$("#available").html(a.unescape(e)).find("li .drag-item").draggable({connectToSortable:"#active-navigation",helper:"clone",distance:10,stop:l})});$("#active-navigation").sortable().droppable({accept:$("#available li .drag-item")});$("#enabled").on("click",".iconPicker",function(){var a=$(this).find("i");e.init(a,function(e){var n=e.attr("value");var i=a.parents("[data-index]").attr("data-index");$('#active-navigation [data-index="'+i+'"] i').attr("class","fa fa-fw "+n);a.siblings('[name="iconClass"]').val(n);a.siblings(".change-icon-link").toggleClass("hidden",!!n)})});$("#active-navigation").on("click","li",t);$("#enabled").on("click",".delete",s).on("click",".toggle",c);$("#save").on("click",r)};function t(){var a=$(this).attr("data-index");$("#active-navigation li").removeClass("active");$(this).addClass("active");var e=$("#enabled").children('[data-index="'+a+'"]');$("#enabled li").addClass("hidden");if(e.length){e.removeClass("hidden")}return false}function l(e,n){var t=n.helper.attr("data-id");var l=$('#active-navigation [data-id="'+t+'"]');var r=t==="custom"?{iconClass:"fa-navicon"}:i[t];r.enabled=false;r.index=(parseInt($("#enabled").children().last().attr("data-index"),10)||0)+1;templates.parse("admin/general/navigation","navigation",{navigation:[r]},function(e){a.translate(e,function(e){e=$(a.unescape(e));l.after(e);l.remove()})});templates.parse("admin/general/navigation","enabled",{enabled:[r]},function(e){a.translate(e,function(e){e=$(a.unescape(e));$("#enabled").append(e);componentHandler.upgradeDom()})})}function r(){var e=[];var n=[];$("#active-navigation li").each(function(){n.push($(this).attr("data-index"))});n.forEach(function(n){var i=$("#enabled").children('[data-index="'+n+'"]');var t=i.find("form").serializeArray();var l={};var r={};t.forEach(function(e){if(e.name.slice(0,9)==="property:"&&e.value==="on"){r[e.name.slice(9)]=true}else{l[e.name]=a.escape(e.value)}});l.properties={};for(var s in r){if(r.hasOwnProperty(s)){l.properties[s]=r[s]}}e.push(l)});socket.emit("admin.navigation.save",e,function(a){if(a){app.alertError(a.message)}else{app.alertSuccess("Successfully saved navigation")}})}function s(){var a=$(this).parents("[data-index]").attr("data-index");$('#active-navigation [data-index="'+a+'"]').remove();$('#enabled [data-index="'+a+'"]').remove();return false}function c(){var e=$(this);var n=e.hasClass("btn-success");a.translate(n?"[[admin/general/navigation:btn.disable]]":"[[admin/general/navigation:btn.enable]]",function(a){e.toggleClass("btn-warning").toggleClass("btn-success").html(a);e.parents("li").find('[name="enabled"]').val(n?"on":"")});return false}return n});
//# sourceMappingURL=public/src/admin/general/navigation.js.map