{"version":3,"sources":["public/src/admin/advanced/errors.js"],"names":["define","Chart","Errors","init","setupCharts","$","on","clear404","bootbox","confirm","ok","socket","emit","err","app","alertError","message","ajaxify","refresh","alertSuccess","notFoundCanvas","document","getElementById","tooBusyCanvas","dailyLabels","utils","getDaysArray","slice","isMobile","defaults","global","tooltips","enabled","data","not-found","labels","datasets","label","backgroundColor","borderColor","pointBackgroundColor","pointHoverBackgroundColor","pointBorderColor","pointHoverBorderColor","analytics","toobusy","width","parent","getContext","type","options","responsive","legend","display","scales","yAxes","ticks","beginAtZero"],"mappings":"AAAA,aAGAA,OAAO,yBAA0B,SAAU,SAAUC,GACpD,IAAIC,KAEJA,EAAOC,KAAO,WACbD,EAAOE,cAEPC,EAAE,yBAAyBC,GAAG,QAASJ,EAAOK,WAG/CL,EAAOK,SAAW,WACjBC,QAAQC,QAAQ,6CAA8C,SAAUC,GACvE,GAAIA,EAAI,CACPC,OAAOC,KAAK,wBAA0B,SAAUC,GAC/C,GAAIA,EAAK,CACR,OAAOC,IAAIC,WAAWF,EAAIG,SAG3BC,QAAQC,UACRJ,IAAIK,aAAa,oDAMrBjB,EAAOE,YAAc,WACpB,IAAIgB,EAAiBC,SAASC,eAAe,aAC7C,IAAIC,EAAgBF,SAASC,eAAe,WAC5C,IAAIE,EAAcC,MAAMC,eAExBF,EAAcA,EAAYG,OAAO,GAEjC,GAAIF,MAAMG,WAAY,CACrB3B,EAAM4B,SAASC,OAAOC,SAASC,QAAU,MAG1C,IAAIC,GACHC,aACCC,OAAQX,EACRY,WAEEC,MAAO,GACPC,gBAAiB,wBACjBC,YAAa,sBACbC,qBAAsB,sBACtBC,0BAA2B,OAC3BC,iBAAkB,OAClBC,sBAAuB,sBACvBV,KAAMhB,QAAQgB,KAAKW,UAAU,gBAIhCC,SACCV,OAAQX,EACRY,WAEEC,MAAO,GACPC,gBAAiB,wBACjBC,YAAa,sBACbC,qBAAsB,sBACtBC,0BAA2B,OAC3BC,iBAAkB,OAClBC,sBAAuB,sBACvBV,KAAMhB,QAAQgB,KAAKW,UAAUC,YAMjCzB,EAAe0B,MAAQzC,EAAEe,GAAgB2B,SAASD,QAClDvB,EAAcuB,MAAQzC,EAAEkB,GAAewB,SAASD,QAEhD,IAAI7C,EAAMmB,EAAe4B,WAAW,OACnCC,KAAM,OACNhB,KAAMA,EAAK,aACXiB,SACCC,WAAY,KACZC,QACCC,QAAS,OAEVC,QACCC,QACCC,OACCC,YAAa,YAOlB,IAAIxD,EAAMsB,EAAcyB,WAAW,OAClCC,KAAM,OACNhB,KAAMA,EAAKY,QACXK,SACCC,WAAY,KACZC,QACCC,QAAS,OAEVC,QACCC,QACCC,OACCC,YAAa,aAQnB,OAAOvD","file":"public/src/admin/advanced/errors.js","sourcesContent":["'use strict';\n\n\ndefine('admin/advanced/errors', ['Chart'], function (Chart) {\n\tvar Errors = {};\n\n\tErrors.init = function () {\n\t\tErrors.setupCharts();\n\n\t\t$('[data-action=\"clear\"]').on('click', Errors.clear404);\n\t};\n\n\tErrors.clear404 = function () {\n\t\tbootbox.confirm('[[admin/advanced/errors:clear404-confirm]]', function (ok) {\n\t\t\tif (ok) {\n\t\t\t\tsocket.emit('admin.errors.clear', {}, function (err) {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn app.alertError(err.message);\n\t\t\t\t\t}\n\n\t\t\t\t\tajaxify.refresh();\n\t\t\t\t\tapp.alertSuccess('[[admin/advanced/errors:clear404-success]]');\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t};\n\n\tErrors.setupCharts = function () {\n\t\tvar notFoundCanvas = document.getElementById('not-found');\n\t\tvar tooBusyCanvas = document.getElementById('toobusy');\n\t\tvar dailyLabels = utils.getDaysArray();\n\n\t\tdailyLabels = dailyLabels.slice(-7);\n\n\t\tif (utils.isMobile()) {\n\t\t\tChart.defaults.global.tooltips.enabled = false;\n\t\t}\n\n\t\tvar data = {\n\t\t\t'not-found': {\n\t\t\t\tlabels: dailyLabels,\n\t\t\t\tdatasets: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: '',\n\t\t\t\t\t\tbackgroundColor: 'rgba(186,139,175,0.2)',\n\t\t\t\t\t\tborderColor: 'rgba(186,139,175,1)',\n\t\t\t\t\t\tpointBackgroundColor: 'rgba(186,139,175,1)',\n\t\t\t\t\t\tpointHoverBackgroundColor: '#fff',\n\t\t\t\t\t\tpointBorderColor: '#fff',\n\t\t\t\t\t\tpointHoverBorderColor: 'rgba(186,139,175,1)',\n\t\t\t\t\t\tdata: ajaxify.data.analytics['not-found'],\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\ttoobusy: {\n\t\t\t\tlabels: dailyLabels,\n\t\t\t\tdatasets: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: '',\n\t\t\t\t\t\tbackgroundColor: 'rgba(151,187,205,0.2)',\n\t\t\t\t\t\tborderColor: 'rgba(151,187,205,1)',\n\t\t\t\t\t\tpointBackgroundColor: 'rgba(151,187,205,1)',\n\t\t\t\t\t\tpointHoverBackgroundColor: '#fff',\n\t\t\t\t\t\tpointBorderColor: '#fff',\n\t\t\t\t\t\tpointHoverBorderColor: 'rgba(151,187,205,1)',\n\t\t\t\t\t\tdata: ajaxify.data.analytics.toobusy,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\n\t\tnotFoundCanvas.width = $(notFoundCanvas).parent().width();\n\t\ttooBusyCanvas.width = $(tooBusyCanvas).parent().width();\n\n\t\tnew Chart(notFoundCanvas.getContext('2d'), {\n\t\t\ttype: 'line',\n\t\t\tdata: data['not-found'],\n\t\t\toptions: {\n\t\t\t\tresponsive: true,\n\t\t\t\tlegend: {\n\t\t\t\t\tdisplay: false,\n\t\t\t\t},\n\t\t\t\tscales: {\n\t\t\t\t\tyAxes: [{\n\t\t\t\t\t\tticks: {\n\t\t\t\t\t\t\tbeginAtZero: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t}],\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tnew Chart(tooBusyCanvas.getContext('2d'), {\n\t\t\ttype: 'line',\n\t\t\tdata: data.toobusy,\n\t\t\toptions: {\n\t\t\t\tresponsive: true,\n\t\t\t\tlegend: {\n\t\t\t\t\tdisplay: false,\n\t\t\t\t},\n\t\t\t\tscales: {\n\t\t\t\t\tyAxes: [{\n\t\t\t\t\t\tticks: {\n\t\t\t\t\t\t\tbeginAtZero: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t}],\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t};\n\n\treturn Errors;\n});\n"]}