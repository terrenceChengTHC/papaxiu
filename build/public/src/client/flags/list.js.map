{"version":3,"sources":["public/src/client/flags/list.js"],"names":["define","components","Chart","Flags","init","enableFilterForm","enableChatButtons","handleGraphs","filtersEl","get","filter","ajaxify","data","filters","hasOwnProperty","find","val","on","payload","serializeArray","item","value","go","$","param","app","newChat","this","getAttribute","dailyCanvas","document","getElementById","dailyLabels","utils","getDaysArray","map","text","idx","isMobile","defaults","global","tooltips","enabled","flags:daily","labels","datasets","label","backgroundColor","borderColor","pointBackgroundColor","pointHoverBackgroundColor","pointBorderColor","pointHoverBorderColor","analytics","width","parent","getContext","type","options","responsive","animation","legend","display","scales","yAxes","ticks","beginAtZero"],"mappings":"AAAA,aAIAA,OAAO,oBAAqB,aAAc,SAAU,SAAUC,EAAYC,GACzE,IAAIC,KAEJA,EAAMC,KAAO,WACZD,EAAME,mBACNF,EAAMG,oBACNH,EAAMI,gBAGPJ,EAAME,iBAAmB,WACxB,IAAIG,EAAYP,EAAWQ,IAAI,iBAG/B,IAAK,IAAIC,KAAUC,QAAQC,KAAKC,QAAS,CACxC,GAAIF,QAAQC,KAAKC,QAAQC,eAAeJ,GAAS,CAChDF,EAAUO,KAAK,UAAYL,EAAS,MAAMM,IAAIL,QAAQC,KAAKC,QAAQH,KAIrEF,EAAUO,KAAK,UAAUE,GAAG,QAAS,WACpC,IAAIC,EAAUV,EAAUW,iBAAiBT,OAAO,SAAUU,GACzD,QAASA,EAAKC,QAEfV,QAAQW,GAAG,SAAWC,EAAEC,MAAMN,OAIhCf,EAAMG,kBAAoB,WACzBiB,EAAE,eAAeN,GAAG,QAAS,WAC5BQ,IAAIC,QAAQC,KAAKC,aAAa,iBAIhCzB,EAAMI,aAAe,WACpB,IAAIsB,EAAcC,SAASC,eAAe,eAC1C,IAAIC,EAAcC,MAAMC,eAAeC,IAAI,SAAUC,EAAMC,GAC1D,OAAOA,EAAM,EAAI,GAAKD,IAGvB,GAAIH,MAAMK,WAAY,CACrBpC,EAAMqC,SAASC,OAAOC,SAASC,QAAU,MAE1C,IAAI9B,GACH+B,eACCC,OAAQZ,EACRa,WAEEC,MAAO,GACPC,gBAAiB,wBACjBC,YAAa,sBACbC,qBAAsB,sBACtBC,0BAA2B,OAC3BC,iBAAkB,OAClBC,sBAAuB,sBACvBxC,KAAMD,QAAQC,KAAKyC,cAMvBxB,EAAYyB,MAAQ/B,EAAEM,GAAa0B,SAASD,QAC5C,IAAIpD,EAAM2B,EAAY2B,WAAW,OAChCC,KAAM,OACN7C,KAAMA,EAAK,eACX8C,SACCC,WAAY,KACZC,UAAW,MACXC,QACCC,QAAS,OAEVC,QACCC,QACCC,OACCC,YAAa,aAQnB,OAAO/D","file":"public/src/client/flags/list.js","sourcesContent":["'use strict';\n\n/* globals define */\n\ndefine('forum/flags/list', ['components', 'Chart'], function (components, Chart) {\n\tvar Flags = {};\n\n\tFlags.init = function () {\n\t\tFlags.enableFilterForm();\n\t\tFlags.enableChatButtons();\n\t\tFlags.handleGraphs();\n\t};\n\n\tFlags.enableFilterForm = function () {\n\t\tvar filtersEl = components.get('flags/filters');\n\n\t\t// Parse ajaxify data to set form values to reflect current filters\n\t\tfor (var filter in ajaxify.data.filters) {\n\t\t\tif (ajaxify.data.filters.hasOwnProperty(filter)) {\n\t\t\t\tfiltersEl.find('[name=\"' + filter + '\"]').val(ajaxify.data.filters[filter]);\n\t\t\t}\n\t\t}\n\n\t\tfiltersEl.find('button').on('click', function () {\n\t\t\tvar payload = filtersEl.serializeArray().filter(function (item) {\n\t\t\t\treturn !!item.value;\n\t\t\t});\n\t\t\tajaxify.go('flags?' + $.param(payload));\n\t\t});\n\t};\n\n\tFlags.enableChatButtons = function () {\n\t\t$('[data-chat]').on('click', function () {\n\t\t\tapp.newChat(this.getAttribute('data-chat'));\n\t\t});\n\t};\n\n\tFlags.handleGraphs = function () {\n\t\tvar dailyCanvas = document.getElementById('flags:daily');\n\t\tvar dailyLabels = utils.getDaysArray().map(function (text, idx) {\n\t\t\treturn idx % 3 ? '' : text;\n\t\t});\n\n\t\tif (utils.isMobile()) {\n\t\t\tChart.defaults.global.tooltips.enabled = false;\n\t\t}\n\t\tvar data = {\n\t\t\t'flags:daily': {\n\t\t\t\tlabels: dailyLabels,\n\t\t\t\tdatasets: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: '',\n\t\t\t\t\t\tbackgroundColor: 'rgba(151,187,205,0.2)',\n\t\t\t\t\t\tborderColor: 'rgba(151,187,205,1)',\n\t\t\t\t\t\tpointBackgroundColor: 'rgba(151,187,205,1)',\n\t\t\t\t\t\tpointHoverBackgroundColor: '#fff',\n\t\t\t\t\t\tpointBorderColor: '#fff',\n\t\t\t\t\t\tpointHoverBorderColor: 'rgba(151,187,205,1)',\n\t\t\t\t\t\tdata: ajaxify.data.analytics,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\n\t\tdailyCanvas.width = $(dailyCanvas).parent().width();\n\t\tnew Chart(dailyCanvas.getContext('2d'), {\n\t\t\ttype: 'line',\n\t\t\tdata: data['flags:daily'],\n\t\t\toptions: {\n\t\t\t\tresponsive: true,\n\t\t\t\tanimation: false,\n\t\t\t\tlegend: {\n\t\t\t\t\tdisplay: false,\n\t\t\t\t},\n\t\t\t\tscales: {\n\t\t\t\t\tyAxes: [{\n\t\t\t\t\t\tticks: {\n\t\t\t\t\t\t\tbeginAtZero: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t}],\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t};\n\n\treturn Flags;\n});\n"]}