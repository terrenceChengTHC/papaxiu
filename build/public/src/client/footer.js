"use strict";define("forum/footer",["notifications","chat","components","translator"],function(t,n,e,a){t.prepareDOM();n.prepareDOM();a.prepareDOM();function o(t,n){$('a[href="'+config.relative_path+t+'"] i').toggleClass("unread-count",n>0).attr("data-content",n>99?"99+":n)}function u(t){e.get("chat/icon").toggleClass("unread-count",t>0).attr("data-content",t>99?"99+":t)}function i(){var t={};function n(n){if(n&&n.posts&&n.posts.length){var o=n.posts[0];if(parseInt(o.uid,10)!==parseInt(app.user.uid,10)&&!t[o.topic.tid]){e();a(o.topic.tid);t[o.topic.tid]=true}}}function e(){var t=parseInt($("#unread-count i").attr("data-content"),10)+1;o(t)}function a(t){$('[data-tid="'+t+'"]').addClass("unread")}$(window).on("action:ajaxify.end",function(n,e){if(e.url){var a=e.url.match(/^topic\/(\d+)/);if(a&&a[1]){delete t[a[1]]}}});socket.on("event:new_post",n)}if(app.user.uid){socket.emit("user.getUnreadCounts",function(n,e){if(n){return app.alert(n.message)}r(e);u(e.unreadChatCount);t.updateNotifCount(e.unreadNotificationCount)})}function r(t){o("/unread",t.unreadTopicCount);o("/unread/new",t.unreadNewTopicCount);o("/unread/watched",t.unreadWatchedTopicCount)}socket.on("event:unread.updateCount",r);socket.on("event:unread.updateChatCount",u);i()});
//# sourceMappingURL=public/src/client/footer.js.map