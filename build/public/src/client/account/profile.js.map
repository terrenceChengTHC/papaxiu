{"version":3,"sources":["public/src/client/account/profile.js"],"names":["define","header","infinitescroll","Account","theirid","init","ajaxify","data","app","enterRoom","processPage","socket","removeListener","onUserStatusChange","on","config","usePagination","loadMorePosts","$","addClass","parseInt","uid","updateUserStatus","status","direction","length","removeClass","loadMore","after","attr","done","posts","onPostsLoaded","nextStart","callback","filter","post","pid","parseAndTranslate","html","append","find","timeago"],"mappings":"AAAA,aAGAA,OAAO,yBACN,uBACA,uBACA,cACE,SAAUC,EAAQC,GACpB,IAAIC,KACJ,IAAIC,EAEJD,EAAQE,KAAO,WACdJ,EAAOI,OAEPD,EAAUE,QAAQC,KAAKH,QAEvBI,IAAIC,UAAU,QAAUL,GAExBM,IAEAC,OAAOC,eAAe,2BAA4BC,GAClDF,OAAOG,GAAG,2BAA4BD,GAEtC,IAAKE,OAAOC,cAAe,CAC1Bd,EAAeG,KAAKY,KAItB,SAASP,IACRQ,EAAE,gGAAgGC,SAAS,kBAG5G,SAASN,EAAmBN,GAC3B,GAAIa,SAASd,QAAQC,KAAKH,QAAS,MAAQgB,SAASb,EAAKc,IAAK,IAAK,CAClE,OAGDb,IAAIc,iBAAiBJ,EAAE,uBAAyBX,EAAKc,IAAM,gCAAiCd,EAAKgB,QAGlG,SAASN,EAAcO,GACtB,GAAIA,EAAY,IAAMN,EAAE,uBAAuBO,OAAQ,CACtD,OAGDP,EAAE,+BAA+BQ,YAAY,UAE7CxB,EAAeyB,SAAS,2BACvBC,MAAOV,EAAE,uBAAuBW,KAAK,kBACrCR,IAAKjB,GACH,SAAUG,EAAMuB,GAClB,GAAIvB,EAAKwB,OAASxB,EAAKwB,MAAMN,OAAQ,CACpCO,EAAczB,EAAKwB,MAAOD,OACpB,CACNA,IAEDZ,EAAE,uBAAuBW,KAAK,iBAAkBtB,EAAK0B,WACrDf,EAAE,+BAA+BC,SAAS,YAI5C,SAASa,EAAcD,EAAOG,GAC7BH,EAAQA,EAAMI,OAAO,SAAUC,GAC9B,OAAQlB,EAAE,iCAAmCkB,EAAKC,IAAM,KAAKZ,SAG9D,IAAKM,EAAMN,OAAQ,CAClB,OAAOS,IAGR1B,IAAI8B,kBAAkB,kBAAmB,SAAWP,MAAOA,GAAS,SAAUQ,GAC7ErB,EAAE,uBAAuBsB,OAAOD,GAChCA,EAAKE,KAAK,YAAYC,UAEtBR,MAIF,OAAO/B","file":"public/src/client/account/profile.js","sourcesContent":["'use strict';\n\n\ndefine('forum/account/profile', [\n\t'forum/account/header',\n\t'forum/infinitescroll',\n\t'components',\n], function (header, infinitescroll) {\n\tvar Account = {};\n\tvar theirid;\n\n\tAccount.init = function () {\n\t\theader.init();\n\n\t\ttheirid = ajaxify.data.theirid;\n\n\t\tapp.enterRoom('user/' + theirid);\n\n\t\tprocessPage();\n\n\t\tsocket.removeListener('event:user_status_change', onUserStatusChange);\n\t\tsocket.on('event:user_status_change', onUserStatusChange);\n\n\t\tif (!config.usePagination) {\n\t\t\tinfinitescroll.init(loadMorePosts);\n\t\t}\n\t};\n\n\tfunction processPage() {\n\t\t$('[component=\"posts\"] img:not(.not-responsive), [component=\"aboutme\"] img:not(.not-responsive)').addClass('img-responsive');\n\t}\n\n\tfunction onUserStatusChange(data) {\n\t\tif (parseInt(ajaxify.data.theirid, 10) !== parseInt(data.uid, 10)) {\n\t\t\treturn;\n\t\t}\n\n\t\tapp.updateUserStatus($('.account [data-uid=\"' + data.uid + '\"] [component=\"user/status\"]'), data.status);\n\t}\n\n\tfunction loadMorePosts(direction) {\n\t\tif (direction < 0 || !$('[component=\"posts\"]').length) {\n\t\t\treturn;\n\t\t}\n\n\t\t$('[component=\"posts/loading\"]').removeClass('hidden');\n\n\t\tinfinitescroll.loadMore('posts.loadMoreUserPosts', {\n\t\t\tafter: $('[component=\"posts\"]').attr('data-nextstart'),\n\t\t\tuid: theirid,\n\t\t}, function (data, done) {\n\t\t\tif (data.posts && data.posts.length) {\n\t\t\t\tonPostsLoaded(data.posts, done);\n\t\t\t} else {\n\t\t\t\tdone();\n\t\t\t}\n\t\t\t$('[component=\"posts\"]').attr('data-nextstart', data.nextStart);\n\t\t\t$('[component=\"posts/loading\"]').addClass('hidden');\n\t\t});\n\t}\n\n\tfunction onPostsLoaded(posts, callback) {\n\t\tposts = posts.filter(function (post) {\n\t\t\treturn !$('[component=\"posts\"] [data-pid=' + post.pid + ']').length;\n\t\t});\n\n\t\tif (!posts.length) {\n\t\t\treturn callback();\n\t\t}\n\n\t\tapp.parseAndTranslate('account/profile', 'posts', { posts: posts }, function (html) {\n\t\t\t$('[component=\"posts\"]').append(html);\n\t\t\thtml.find('.timeago').timeago();\n\n\t\t\tcallback();\n\t\t});\n\t}\n\n\treturn Account;\n});\n"]}