{"version":3,"sources":["public/src/modules/alerts.js"],"names":["define","translator","components","module","alert","params","alert_id","Date","getTime","title","trim","message","type","$","length","updateAlert","createNew","templates","parse","alertTpl","translate","translatedHTML","fadeIn","get","prepend","closefn","find","on","fadeOut","timeout","startTimeout","clickfn","addClass","e","target","is","remove","id","html","attr","clearTimeout","parseInt","children","off","removeClass","this","timeoutId","setTimeout"],"mappings":"AAAA,aAGAA,OAAO,UAAW,aAAc,cAAe,SAAUC,EAAYC,GACpE,IAAIC,KAEJA,EAAOC,MAAQ,SAAUC,GACxBA,EAAOC,SAAW,iBAAmBD,EAAOC,SAAWD,EAAOC,UAAW,IAAIC,MAAOC,WACpFH,EAAOI,MAAQJ,EAAOI,MAAQJ,EAAOI,MAAMC,QAAU,GAAK,GAC1DL,EAAOM,QAAUN,EAAOM,QAAUN,EAAOM,QAAQD,OAAS,GAC1DL,EAAOO,KAAOP,EAAOO,MAAQ,OAE7B,IAAIR,EAAQS,EAAE,IAAMR,EAAOC,UAC3B,GAAIF,EAAMU,OAAQ,CACjBC,EAAYX,EAAOC,OACb,CACNW,EAAUX,KAIZ,SAASW,EAAUX,GAClBY,UAAUC,MAAM,QAASb,EAAQ,SAAUc,GAC1ClB,EAAWmB,UAAUD,EAAU,SAAUE,GACxC,IAAIjB,EAAQS,EAAE,IAAMR,EAAOC,UAC3B,GAAIF,EAAMU,OAAQ,CACjB,OAAOC,EAAYX,EAAOC,GAE3BD,EAAQS,EAAEQ,GACVjB,EAAMkB,OAAO,KAEbpB,EAAWqB,IAAI,gBAAgBC,QAAQpB,GAEvC,UAAWC,EAAOoB,UAAY,WAAY,CACzCrB,EAAMsB,KAAK,UAAUC,GAAG,QAAS,WAChCtB,EAAOoB,UACPG,EAAQxB,GACR,OAAO,QAIT,GAAIC,EAAOwB,QAAS,CACnBC,EAAa1B,EAAOC,EAAOwB,SAG5B,UAAWxB,EAAO0B,UAAY,WAAY,CACzC3B,EACE4B,SAAS,WACTL,GAAG,QAAS,SAAUM,GACtB,IAAKpB,EAAEoB,EAAEC,QAAQC,GAAG,UAAW,CAC9B9B,EAAO0B,UAERH,EAAQxB,UAOdD,EAAOiC,OAAS,SAAUC,GACzBxB,EAAE,iBAAmBwB,GAAID,UAG1B,SAASrB,EAAYX,EAAOC,GAC3BD,EAAMsB,KAAK,UAAUY,KAAKjC,EAAOI,OACjCL,EAAMsB,KAAK,KAAKY,KAAKjC,EAAOM,SAC5BP,EAAMmC,KAAK,QAAS,iCAAmClC,EAAOO,MAE9D4B,aAAaC,SAASrC,EAAMmC,KAAK,aAAc,KAC/C,GAAIlC,EAAOwB,QAAS,CACnBC,EAAa1B,EAAOC,EAAOwB,SAG5BzB,EAAMsC,WAAWd,QAAQ,KACzB3B,EAAWmB,UAAUhB,EAAMkC,OAAQ,SAAUjB,GAC5CjB,EAAMsC,WAAWpB,OAAO,KACxBlB,EAAMkC,KAAKjB,KAIZjB,EAAMuC,IAAI,SAASC,YAAY,WAC/B,UAAWvC,EAAO0B,UAAY,WAAY,CACzC3B,EACE4B,SAAS,WACTL,GAAG,QAAS,SAAUM,GACtB,IAAKpB,EAAEoB,EAAEC,QAAQC,GAAG,UAAW,CAC9B9B,EAAO0B,UAERH,EAAQxB,MAKZ,SAASwB,EAAQxB,GAChBA,EAAMwB,QAAQ,IAAK,WAClBf,EAAEgC,MAAMT,WAIV,SAASN,EAAa1B,EAAOyB,GAC5B,IAAIiB,EAAYC,WAAW,WAC1BnB,EAAQxB,IACNyB,GAEHzB,EAAMmC,KAAK,YAAaO,GAGzB,OAAO3C","file":"public/src/modules/alerts.js","sourcesContent":["'use strict';\n\n\ndefine('alerts', ['translator', 'components'], function (translator, components) {\n\tvar module = {};\n\n\tmodule.alert = function (params) {\n\t\tparams.alert_id = 'alert_button_' + (params.alert_id ? params.alert_id : new Date().getTime());\n\t\tparams.title = params.title ? params.title.trim() || '' : '';\n\t\tparams.message = params.message ? params.message.trim() : '';\n\t\tparams.type = params.type || 'info';\n\n\t\tvar alert = $('#' + params.alert_id);\n\t\tif (alert.length) {\n\t\t\tupdateAlert(alert, params);\n\t\t} else {\n\t\t\tcreateNew(params);\n\t\t}\n\t};\n\n\tfunction createNew(params) {\n\t\ttemplates.parse('alert', params, function (alertTpl) {\n\t\t\ttranslator.translate(alertTpl, function (translatedHTML) {\n\t\t\t\tvar alert = $('#' + params.alert_id);\n\t\t\t\tif (alert.length) {\n\t\t\t\t\treturn updateAlert(alert, params);\n\t\t\t\t}\n\t\t\t\talert = $(translatedHTML);\n\t\t\t\talert.fadeIn(200);\n\n\t\t\t\tcomponents.get('toaster/tray').prepend(alert);\n\n\t\t\t\tif (typeof params.closefn === 'function') {\n\t\t\t\t\talert.find('button').on('click', function () {\n\t\t\t\t\t\tparams.closefn();\n\t\t\t\t\t\tfadeOut(alert);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (params.timeout) {\n\t\t\t\t\tstartTimeout(alert, params.timeout);\n\t\t\t\t}\n\n\t\t\t\tif (typeof params.clickfn === 'function') {\n\t\t\t\t\talert\n\t\t\t\t\t\t.addClass('pointer')\n\t\t\t\t\t\t.on('click', function (e) {\n\t\t\t\t\t\t\tif (!$(e.target).is('.close')) {\n\t\t\t\t\t\t\t\tparams.clickfn();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfadeOut(alert);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tmodule.remove = function (id) {\n\t\t$('#alert_button_' + id).remove();\n\t};\n\n\tfunction updateAlert(alert, params) {\n\t\talert.find('strong').html(params.title);\n\t\talert.find('p').html(params.message);\n\t\talert.attr('class', 'alert alert-dismissable alert-' + params.type);\n\n\t\tclearTimeout(parseInt(alert.attr('timeoutId'), 10));\n\t\tif (params.timeout) {\n\t\t\tstartTimeout(alert, params.timeout);\n\t\t}\n\n\t\talert.children().fadeOut(100);\n\t\ttranslator.translate(alert.html(), function (translatedHTML) {\n\t\t\talert.children().fadeIn(100);\n\t\t\talert.html(translatedHTML);\n\t\t});\n\n\t\t// Handle changes in the clickfn\n\t\talert.off('click').removeClass('pointer');\n\t\tif (typeof params.clickfn === 'function') {\n\t\t\talert\n\t\t\t\t.addClass('pointer')\n\t\t\t\t.on('click', function (e) {\n\t\t\t\t\tif (!$(e.target).is('.close')) {\n\t\t\t\t\t\tparams.clickfn();\n\t\t\t\t\t}\n\t\t\t\t\tfadeOut(alert);\n\t\t\t\t});\n\t\t}\n\t}\n\n\tfunction fadeOut(alert) {\n\t\talert.fadeOut(500, function () {\n\t\t\t$(this).remove();\n\t\t});\n\t}\n\n\tfunction startTimeout(alert, timeout) {\n\t\tvar timeoutId = setTimeout(function () {\n\t\t\tfadeOut(alert);\n\t\t}, timeout);\n\n\t\talert.attr('timeoutId', timeoutId);\n\t}\n\n\treturn module;\n});\n"]}