{"version":3,"sources":["public/src/modules/taskbar.js"],"names":["define","taskbar","init","self","this","templates","parse","html","$","tasklist","find","document","body","append","on","$btn","module","attr","uuid","require","hasClass","minimizeAll","load","toggleNew","app","alternatingTitle","removeClass","addClass","minimize","discard","btnEl","remove","update","push","options","element","data","window","trigger","length","createTaskbar","get","items","map","idx","el","toggleClass","state","silent","updateActive","tasks","filter","isActive","taskBtn","removeAttr","title","text","taskbarEl","className","icon","image","data-module","data-uuid","undefined","updateTitle","newTitle"],"mappings":"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","file":"public/src/modules/taskbar.js","sourcesContent":["'use strict';\n\n\ndefine('taskbar', function () {\n\tvar taskbar = {};\n\n\ttaskbar.init = function () {\n\t\tvar self = this;\n\n\t\ttemplates.parse('modules/taskbar', {}, function (html) {\n\t\t\tself.taskbar = $(html);\n\t\t\tself.tasklist = self.taskbar.find('ul');\n\t\t\t$(document.body).append(self.taskbar);\n\n\t\t\tself.taskbar.on('click', 'li', function () {\n\t\t\t\tvar\t$btn = $(this);\n\t\t\t\tvar module = $btn.attr('data-module');\n\t\t\t\tvar uuid = $btn.attr('data-uuid');\n\n\t\t\t\trequire([module], function (module) {\n\t\t\t\t\tif (!$btn.hasClass('active')) {\n\t\t\t\t\t\tminimizeAll();\n\t\t\t\t\t\tmodule.load(uuid);\n\t\t\t\t\t\ttaskbar.toggleNew(uuid, false);\n\t\t\t\t\t\tapp.alternatingTitle('');\n\n\t\t\t\t\t\ttaskbar.tasklist.removeClass('active');\n\t\t\t\t\t\t$btn.addClass('active');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmodule.minimize(uuid);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn false;\n\t\t\t});\n\t\t});\n\t};\n\n\ttaskbar.discard = function (module, uuid) {\n\t\tvar btnEl = taskbar.tasklist.find('[data-module=\"' + module + '\"][data-uuid=\"' + uuid + '\"]');\n\t\tbtnEl.remove();\n\n\t\tupdate();\n\t};\n\n\ttaskbar.push = function (module, uuid, options) {\n\t\tvar element = taskbar.tasklist.find('li[data-uuid=\"' + uuid + '\"]');\n\n\t\tvar data = {\n\t\t\tmodule: module,\n\t\t\tuuid: uuid,\n\t\t\toptions: options,\n\t\t\telement: element,\n\t\t};\n\n\t\t$(window).trigger('filter:taskbar.push', data);\n\n\t\tif (!element.length && data.module) {\n\t\t\tcreateTaskbar(data);\n\t\t}\n\t};\n\n\ttaskbar.get = function (module) {\n\t\tvar items = $('[data-module=\"' + module + '\"]').map(function (idx, el) {\n\t\t\treturn $(el).data();\n\t\t});\n\n\t\treturn items;\n\t};\n\n\ttaskbar.minimize = function (module, uuid) {\n\t\tvar btnEl = taskbar.tasklist.find('[data-module=\"' + module + '\"][data-uuid=\"' + uuid + '\"]');\n\t\tbtnEl.toggleClass('active', false);\n\t};\n\n\ttaskbar.toggleNew = function (uuid, state, silent) {\n\t\tvar btnEl = taskbar.tasklist.find('[data-uuid=\"' + uuid + '\"]');\n\t\tbtnEl.toggleClass('new', state);\n\n\t\tif (!silent) {\n\t\t\t$(window).trigger('action:taskbar.toggleNew', uuid);\n\t\t}\n\t};\n\n\ttaskbar.updateActive = function (uuid) {\n\t\tvar\ttasks = taskbar.tasklist.find('li');\n\t\ttasks.removeClass('active');\n\t\ttasks.filter('[data-uuid=\"' + uuid + '\"]').addClass('active');\n\t};\n\n\ttaskbar.isActive = function (uuid) {\n\t\tvar taskBtn = taskbar.tasklist.find('li[data-uuid=\"' + uuid + '\"]');\n\t\treturn taskBtn.hasClass('active');\n\t};\n\n\tfunction update() {\n\t\tvar\ttasks = taskbar.tasklist.find('li');\n\n\t\tif (tasks.length > 0) {\n\t\t\ttaskbar.taskbar.attr('data-active', '1');\n\t\t} else {\n\t\t\ttaskbar.taskbar.removeAttr('data-active');\n\t\t}\n\t}\n\n\tfunction minimizeAll() {\n\t\ttaskbar.tasklist.find('.active').removeClass('active');\n\t}\n\n\tfunction createTaskbar(data) {\n\t\tvar title = $('<div></div>').text(data.options.title || 'NodeBB Task').html();\n\n\t\tvar\ttaskbarEl = $('<li />')\n\t\t\t.addClass(data.options.className)\n\t\t\t.html('<a href=\"#\">' +\n\t\t\t\t(data.options.icon ? '<i class=\"fa ' + data.options.icon + '\"></i> ' : '') +\n\t\t\t\t(data.options.image ? '<img src=\"' + data.options.image + '\"/> ' : '') +\n\t\t\t\t'<span component=\"taskbar/title\">' + title + '</span>' +\n\t\t\t\t'</a>')\n\t\t\t.attr({\n\t\t\t\t'data-module': data.module,\n\t\t\t\t'data-uuid': data.uuid,\n\t\t\t})\n\t\t\t.addClass(data.options.state !== undefined ? data.options.state : 'active');\n\n\t\tif (!data.options.state || data.options.state === 'active') {\n\t\t\tminimizeAll();\n\t\t}\n\n\t\ttaskbar.tasklist.append(taskbarEl);\n\t\tupdate();\n\n\t\tdata.element = taskbarEl;\n\n\t\ttaskbarEl.data(data);\n\t\t$(window).trigger('action:taskbar.pushed', data);\n\t}\n\n\ttaskbar.updateTitle = function (module, uuid, newTitle) {\n\t\ttaskbar.tasklist.find('[data-module=\"' + module + '\"][data-uuid=\"' + uuid + '\"] [component=\"taskbar/title\"]').text(newTitle);\n\t};\n\n\treturn taskbar;\n});\n"]}